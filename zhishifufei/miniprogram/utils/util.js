"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.formatHtml = exports.config = exports.post = exports.get = exports.formatTime = void 0;
exports.formatTime = function (date) {
    var year = date.getFullYear();
    var month = date.getMonth() + 1;
    var day = date.getDate();
    var hour = date.getHours();
    var minute = date.getMinutes();
    var second = date.getSeconds();
    return ([year, month, day].map(formatNumber).join('/') +
        ' ' +
        [hour, minute, second].map(formatNumber).join(':'));
};
var formatNumber = function (n) {
    var s = n.toString();
    return s[1] ? s : '0' + s;
};
var appCode = "V91DCWGV0F0U";
var appToken = "e09f8f7f3346685928a1a24559979a9624a768fd8f56da63bac52cda5b88b80b";
var baseUrl = "http://localhost:9000/api/zhishifufei/";
exports.get = function (url, callback) {
    wx.request({
        url: baseUrl + url,
        method: "GET",
        header: {
            token: wx.getStorageSync("token"),
            appCode: appCode,
            appToken: appToken,
        },
        success: function (response) {
            callback(response.data);
        },
        fail: function (response) {
            wx.showToast({
                title: response.errMsg,
                icon: 'none',
            }).then();
        }
    });
};
exports.post = function (url, data, callback) {
    wx.request({
        url: baseUrl + url,
        method: "POST",
        header: {
            'content-type': 'application/x-www-form-urlencoded',
            token: wx.getStorageSync("token"),
            appCode: appCode,
            appToken: appToken,
        },
        data: data,
        success: function (response) {
            callback(response.data);
        },
        fail: function (response) {
            wx.showToast({
                title: response.errMsg,
                icon: 'none',
            }).then();
        }
    });
};
exports.config = function () {
    exports.get("config", function (response) {
        console.log("get config", response.data);
        wx.setStorageSync("appConfig", response.data);
    });
};
exports.formatHtml = function (html) {
    var newContent = html.replace(/<img[^>]*>/gi, function (match) {
        match = match.replace(/style="[^"]+"/gi, '').replace(/style='[^']+'/gi, '');
        match = match.replace(/width="[^"]+"/gi, '').replace(/width='[^']+'/gi, '');
        match = match.replace(/height="[^"]+"/gi, '').replace(/height='[^']+'/gi, '');
        return match;
    });
    newContent = newContent.replace(/style="[^"]+"/gi, function (match) {
        match = match.replace(/width:[^;]+;/gi, 'max-width:100%;').replace(/width:[^;]+;/gi, 'max-width:100%;');
        return match;
    });
    newContent = newContent.replace(/<br[^>]*\/>/gi, '');
    newContent = newContent.replace(/\<img/gi, '<img style="max-width:100%;height:auto;display:block;margin-top:0;margin-bottom:0;"');
    return newContent;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInV0aWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQWEsUUFBQSxVQUFVLEdBQUcsVUFBQyxJQUFVO0lBQ25DLElBQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQTtJQUMvQixJQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsUUFBUSxFQUFFLEdBQUcsQ0FBQyxDQUFBO0lBQ2pDLElBQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQTtJQUMxQixJQUFNLElBQUksR0FBRyxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUE7SUFDNUIsSUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFBO0lBQ2hDLElBQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQTtJQUVoQyxPQUFPLENBQ0wsQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxZQUFZLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDO1FBQzlDLEdBQUc7UUFDSCxDQUFDLElBQUksRUFBRSxNQUFNLEVBQUUsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLFlBQVksQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FDbkQsQ0FBQTtBQUNILENBQUMsQ0FBQTtBQUVELElBQU0sWUFBWSxHQUFHLFVBQUMsQ0FBUztJQUM3QixJQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUE7SUFDdEIsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQTtBQUMzQixDQUFDLENBQUE7QUFFRCxJQUFNLE9BQU8sR0FBQyxjQUFjLENBQUM7QUFDN0IsSUFBTSxRQUFRLEdBQUMsa0VBQWtFLENBQUM7QUFDbEYsSUFBTSxPQUFPLEdBQUMs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Q3hHLE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQyxDQUFDLENBQUM7SUFDSCxVQUFVLEdBQUcsVUFBVSxDQUFDLE9BQU8sQ0FBQyxlQUFlLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDckQsVUFBVSxHQUFHLFVBQVUsQ0FBQyxPQUFPLENBQUMsU0FBUyxFQUFFLHFGQUFxRixDQUFDLENBQUM7SUFDbEksT0FBTyxVQUFVLENBQUM7QUFDcEIsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IGZvcm1hdFRpbWUgPSAoZGF0ZTogRGF0ZSkgPT4ge1xuICBjb25zdCB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpXG4gIGNvbnN0IG1vbnRoID0gZGF0ZS5nZXRNb250aCgpICsgMVxuICBjb25zdCBkYXkgPSBkYXRlLmdldERhdGUoKVxuICBjb25zdCBob3VyID0gZGF0ZS5nZXRIb3VycygpXG4gIGNvbnN0IG1pbnV0ZSA9IGRhdGUuZ2V0TWludXRlcygpXG4gIGNvbnN0IHNlY29uZCA9IGRhdGUuZ2V0U2Vjb25kcygpXG5cbiAgcmV0dXJuIChcbiAgICBbeWVhciwgbW9udGgsIGRheV0ubWFwKGZvcm1hdE51bWJlcikuam9pbignLycpICtcbiAgICAnICcgK1xuICAgIFtob3VyLCBtaW51dGUsIHNlY29uZF0ubWFwKGZvcm1hdE51bWJlcikuam9pbignOicpXG4gIClcbn1cblxuY29uc3QgZm9ybWF0TnVtYmVyID0gKG46IG51bWJlcikgPT4ge1xuICBjb25zdCBzID0gbi50b1N0cmluZygpXG4gIHJldHVybiBzWzFdID8gcyA6ICcwJyArIHNcbn1cblxuY29uc3QgYXBwQ29kZT1cIlY5MURDV0dWMEYwVVwiO1xuY29uc3QgYXBwVG9rZW49XCJlMDlmOGY3ZjMzNDY2ODU5MjhhMWEyNDU1OTk3OWE5NjI0YTc2OGZkOGY1NmRhNjNiYWM1MmNkYTViODhiODBiXCI7XG5jb25zdCBiYXNlVXJsPVwiaHR0cDovL2xvY2FsaG9zdDo5MDAwL2FwaS96aGlzaGlmdWZlaS9cIjtcblxuZXhwb3J0IGNvbnN0IGdldD0odXJsOiBzdHJpbmcsY2FsbGJhY2s6KHJlc3BvbnNlOiBhbnkpPT52b2lkKT0+e1xuICB3eC5yZXF1ZXN0KHtcbiAgICB1cmw6YmFzZVVybCt1cmwsXG4gICAgbWV0aG9kOlwiR0VUXCIsXG4gICAgaGVhZGVyOntcbiAgICAgIHRva2VuOnd4LmdldFN0b3JhZ2VTeW5jKFwidG9rZW5cIiksXG4gICAgICBhcHBDb2RlLFxuICAgICAgYXBwVG9rZW4sXG4gICAgfSxcbiAgICBzdWNjZXNzOmZ1bmN0aW9uIChyZXNwb25zZSl7XG4gICAgICBjYWxsYmFjayhyZXNwb25zZS5kYXRhKTtcbiAgICB9LFxuICAgIGZhaWw6ZnVuY3Rpb24gKHJlc3BvbnNlKXtcbiAgICAgIHd4LnNob3dUb2FzdCh7XG4gICAgICAgIHRpdGxlOiByZXNwb25zZS5lcnJNc2csXG4gICAgICAgIGljb246ICdub25lJyxcbiAgICAgIH0pLnRoZW4oKTtcbiAgICB9XG4gIH0pXG59XG5cbmV4cG9ydCBjb25zdCBwb3N0PSh1cmw6IHN0cmluZyxkYXRhOntba2V5OiBzdHJpbmddOiBhbnl9LGNhbGxiYWNrOihyZXNwb25zZTogYW55KT0+dm9pZCk9PntcbiAgd3gucmVxdWVzdCh7XG4gICAgdXJsOmJhc2VVcmwrdXJsLFxuICAgIG1ldGhvZDpcIlBPU1RcIixcbiAgICBoZWFkZXI6e1xuICAgICAgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnLFxuICAgICAgdG9rZW46d3guZ2V0U3RvcmFnZVN5bmMoXCJ0b2tlblwiKSxcbiAgICAgIGFwcENvZGUsXG4gICAgICBhcHBUb2tlbixcbiAgICB9LFxuICAgIGRhdGEsXG4gICAgc3VjY2VzczpmdW5jdGlvbiAocmVzcG9uc2Upe1xuICAgICAgY2FsbGJhY2socmVzcG9uc2UuZGF0YSk7XG4gICAgfSxcbiAgICBmYWlsOmZ1bmN0aW9uIChyZXNwb25zZSl7XG4gICAgICB3eC5zaG93VG9hc3Qoe1xuICAgICAgICB0aXRsZTogcmVzcG9uc2UuZXJyTXNnLFxuICAgICAgICBpY29uOiAnbm9uZScsXG4gICAgICB9KS50aGVuKCk7XG4gICAgfVxuICB9KVxufVxuXG5cbmV4cG9ydCBjb25zdCBjb25maWcgPSAoKSA9PntcbiAgZ2V0KFwiY29uZmlnXCIsKHJlc3BvbnNlOntjb2RlOiBudW1iZXIsZGF0YTogYW55LCBtc2c6IHN0cmluZ30pID0+IHtcbiAgICBjb25zb2xlLmxvZyhcImdldCBjb25maWdcIixyZXNwb25zZS5kYXRhKTtcbiAgICB3eC5zZXRTdG9yYWdlU3luYyhcImFwcENvbmZpZ1wiLHJlc3BvbnNlLmRhdGEpO1xuICB9KTtcbn1cblxuXG5cbmV4cG9ydCBjb25zdCBmb3JtYXRIdG1sID0gKGh0bWw6IHN0cmluZykgPT4ge1xuICBsZXQgbmV3Q29udGVudCA9IGh0bWwucmVwbGFjZSgvPGltZ1tePl0qPi9naSwgZnVuY3Rpb24gKG1hdGNoKSB7XG4gICAgbWF0Y2ggPSBtYXRjaC5yZXBsYWNlKC9zdHlsZT1cIlteXCJdK1wiL2dpLCAnJykucmVwbGFjZSgvc3R5bGU9J1teJ10rJy9naSwgJycpO1xuICAgIG1hdGNoID0gbWF0Y2gucmVwbGFjZSgvd2lkdGg9XCJbXlwiXStcIi9naSwgJycpLnJlcGxhY2UoL3dpZHRoPSdbXiddKycvZ2ksICcnKTtcbiAgICBtYXRjaCA9IG1hdGNoLnJlcGxhY2UoL2hlaWdodD1cIlteXCJdK1wiL2dpLCAnJykucmVwbGFjZSgvaGVpZ2h0PSdbXiddKycvZ2ksICcnKTtcbiAgICByZXR1cm4gbWF0Y2g7XG4gIH0pO1xuICBuZXdDb250ZW50ID0gbmV3Q29udGVudC5yZXBsYWNlKC9zdHlsZT1cIlteXCJdK1wiL2dpLCBmdW5jdGlvbiAobWF0Y2gpIHtcbiAgICBtYXRjaCA9IG1hdGNoLnJlcGxhY2UoL3dpZHRoOlteO10rOy9naSwgJ21heC13aWR0aDoxMDAlOycpLnJlcGxhY2UoL3dpZHRoOlteO10rOy9naSwgJ21heC13aWR0aDoxMDAlOycpO1xuICAgIHJldHVybiBtYXRjaDtcbiAgfSk7XG4gIG5ld0NvbnRlbnQgPSBuZXdDb250ZW50LnJlcGxhY2UoLzxicltePl0qXFwvPi9naSwgJycpO1xuICBuZXdDb250ZW50ID0gbmV3Q29udGVudC5yZXBsYWNlKC9cXDxpbWcvZ2ksICc8aW1nIHN0eWxlPVwibWF4LXdpZHRoOjEwMCU7aGVpZ2h0OmF1dG87ZGlzcGxheTpibG9jazttYXJnaW4tdG9wOjA7bWFyZ2luLWJvdHRvbTowO1wiJyk7XG4gIHJldHVybiBuZXdDb250ZW50O1xufVxuIl19